<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Python · CCBlade.jl</title><meta name="title" content="Python · CCBlade.jl"/><meta property="og:title" content="Python · CCBlade.jl"/><meta property="twitter:title" content="Python · CCBlade.jl"/><meta name="description" content="Documentation for CCBlade.jl."/><meta property="og:description" content="Documentation for CCBlade.jl."/><meta property="twitter:description" content="Documentation for CCBlade.jl."/><meta property="og:url" content="https://flow.byu.edu/CCBlade.jl/python/"/><meta property="twitter:url" content="https://flow.byu.edu/CCBlade.jl/python/"/><link rel="canonical" href="https://flow.byu.edu/CCBlade.jl/python/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">CCBlade.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Intro</a></li><li><a class="tocitem" href="../tutorial/">Quick Start</a></li><li><a class="tocitem" href="../howto/">Guided Examples</a></li><li><a class="tocitem" href="../reference/">API Reference</a></li><li><a class="tocitem" href="../theory/">Theory</a></li><li class="is-active"><a class="tocitem" href>Python</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Python</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Python</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/byuflowlab/CCBlade.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/byuflowlab/CCBlade.jl/blob/master/docs/src/python.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Calling-CCBlade.jl-from-Python-(optionally-with-derivatives)"><a class="docs-heading-anchor" href="#Calling-CCBlade.jl-from-Python-(optionally-with-derivatives)">Calling CCBlade.jl from Python (optionally with derivatives)</a><a id="Calling-CCBlade.jl-from-Python-(optionally-with-derivatives)-1"></a><a class="docs-heading-anchor-permalink" href="#Calling-CCBlade.jl-from-Python-(optionally-with-derivatives)" title="Permalink"></a></h1><p>In this example we repeat the <a href="../tutorial/">quick start</a>, but with Python.  We won&#39;t repeat all the usage details described in the quick start.  We are using the <a href="https://juliapy.github.io/PythonCall.jl/stable/">JuliaCall</a> packages to enable this.  Notice that the main change from the Julia example is that we need to explicitly use the Julia broadcast functions (which is what the dot syntax does in Julia).</p><pre><code class="language-python hljs">import numpy as np
from juliacall import Main as jl
import matplotlib.pyplot as plt

jl.seval(&quot;using CCBlade&quot;)

Rtip = 10/2.0 * 0.0254  # inches to meters
Rhub = 0.10*Rtip
B = 2  # number of blades

rotor = jl.Rotor(Rhub, Rtip, B)

propgeom = np.array([
    [0.15, 0.130, 32.76],
    [0.20, 0.149, 37.19],
    [0.25, 0.173, 33.54],
    [0.30, 0.189, 29.25],
    [0.35, 0.197, 25.64],
    [0.40, 0.201, 22.54],
    [0.45, 0.200, 20.27],
    [0.50, 0.194, 18.46],
    [0.55, 0.186, 17.05],
    [0.60, 0.174, 15.97],
    [0.65, 0.160, 14.87],
    [0.70, 0.145, 14.09],
    [0.75, 0.128, 13.39],
    [0.80, 0.112, 12.84],
    [0.85, 0.096, 12.25],
    [0.90, 0.081, 11.37],
    [0.95, 0.061, 10.19],
    [1.00, 0.041, 8.99]]
)

r = propgeom[:, 0] * Rtip
chord = propgeom[:, 1] * Rtip
theta = propgeom[:, 2] * np.pi/180

af = jl.AlphaAF(&quot;data/naca4412.dat&quot;)

sections = jl.broadcast(jl.Section, r, chord, theta, jl.Ref(af))

Vinf = 5.0
Omega = 5400*np.pi/30  # convert to rad/s
rho = 1.225

op = jl.broadcast(jl.simple_op, Vinf, Omega, r, rho)

out = jl.broadcast(jl.solve, jl.Ref(rotor), sections, op)

plt.figure()
plt.plot(r/Rtip, out.Np)
plt.plot(r/Rtip, out.Tp)
plt.xlabel(&quot;r/Rtip&quot;)
plt.ylabel(&quot;distributed loads (N/m)&quot;)
plt.legend([&quot;flapwise&quot;, &quot;lead-lag&quot;])
plt.show()</code></pre><p>We now continue the example demonstrating how to get derivatives for use in Python (but where the derivative computationa occurs in Julia via algorithmic differentiation).  For this functionality we need to load the <a href="https://juliapy.github.io/PythonCall.jl/stable/">PythonCall</a> package (which enables us to call back into Python from Julia), and we need the <a href="https://github.com/byuflowlab/ImplicitAD.jl">ImplicitAD</a> packages which provides a convenience function for the derivative computation.  Alternatively, for more advanced users you can just use the Julia differentiation packages directly (ForwardDiff, ReverseDiff, etc.) as demonstrated in the <a href="../howto/">how to guide</a>.  Note that for Julia AD to work, all the function calls will need to be Julia function calls.  Even though all the setup is happening here in Python, we are only setting up inputs.  All functions are calls to Julia (jl.somefunction())</p><p>Not counting the one-time loading cost of starting up the Julia runtime, we find the computational time of computing derivatives to be essentially identical to computing in pure Julia (in other words there is minimal overhead between Python/Julia for these examples).  The below example demonstrates a forward mode Jacobian and a forward mode Jacobian-vector product.  Other options (reverse Jacobian, reverse vector-Jacobian product) are discussed in <a href="https://github.com/byuflowlab/ImplicitAD.jl">ImplicitAD</a> docs.</p><pre><code class="language-python hljs">jl.seval(&quot;using PythonCall&quot;)
jl.seval(&quot;using ImplicitAD: derivativesetup&quot;)

nc = len(chord)

# ImplicitAD expects a funciton we want to differentiate in the form f = func(x, p)
# where f is output vector, x is input vector, and p are parameters we do not differentiate w.r.t.
def ccbladewrap(x, p):
    chord = x[:nc]
    theta = x[nc:]
    sections = jl.broadcast(jl.Section, r, chord, theta, jl.Ref(af))
    out = jl.broadcast(jl.solve, jl.Ref(rotor), sections, op)
    T, Q = jl.thrusttorque(rotor, sections, out)
    return [T, Q]

x = np.concatenate([chord, theta])
p = ()
jacobian = jl.derivativesetup(ccbladewrap, x, p, &quot;fjacobian&quot;)  # a forward-mode Jacobian is one option

# preallocate Jacobian then evaluate
J = np.zeros((2, len(x)))
jacobian(J, x)
print(J)
# can now change x, and evaluate jacobian(J, x) repeatedly at other points


# demonstrate a Jacobian-vector product
jvp = jl.derivativesetup(ccbladewrap, x, p, &quot;jvp&quot;)
xdot = np.ones(len(x))
fdot = np.zeros(2)
jvp(fdot, x, xdot)
print(fdot)
# can continue to call jvp for different x, xdot pairs</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory/">« Theory</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 7 October 2025 16:45">Tuesday 7 October 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
